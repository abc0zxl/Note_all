# 分类表

这个逻辑还是比较复杂的

1.**创建一套属于Category的实现框架**：

2.**设置参数**：他是接受了一个对象，所以是@RequestBody

3.**编写其他的部分**：service，service接口，mapper

4.**注意对象参数逻辑**：初始设置时，肯定设置不了里面的**修改用户**，**修改时间**，

* 在service通过本地线程获取用户名字，
* 设置时间，注意接受时间的属性必须是LocalDateTime

5.**mapper样式**：一个一个导入的

![image.png](/assets/8b3dafc4-6390-420e-ae51-1da459a329a2.png)

# 获取列表

1.**编写controller**：返回类型是List集合

2.**编写service**：返回类型也是list集合

![image.png](/assets/c775f85f-201e-4dd4-b649-896d070c52ff.png)

3.**编写mapper**：它指向sql获取list集合

* select*from category where create_time=#{分类编号}。我这里是category_type

4.**设置日期格式**：@JsonFormat(pattern="yyyy-mm-dd hh:mm:ss")

# 分页列表查询

这个按照需求来，但是基础的参数有两个

* 分页条数
* 分页页码

这里因为要实现分类，和状态查询，所以多了两个

* 分类信息
* 状态信息

1.**创建controller方法**

* **编写参数**：由于后两个参数是非必须的所以可以用注解来声明它。@RequestParam(required=false)

2.**构建PageBean对象**：用于封装查询到的列表，这个实体类在项目SpringBoot_item中，自己找。

* 将Result的对象变为PageBean

3.**编写service**：、

* 创建pagebean对象
* **启动分页插件pageHelper**：这里是mybatis提供的一个工具PageHelper，在sql执行前执行就行

  **第一步**：引入依赖com.github.pagehelper

  **第二步**：在service中编写PageHelper.startPage(bageNum,pageSize)，service的具体内容看下面

  **第三步**：调用mapper，mapper需要三个参数，

4.**mapper参数**：

由于我设计的是一个猫粮管理系统，所以每个商户有自己的猫粮库存。所以需要在查询列表时根据用户id查找自己的列表即可。所以需要引入商品列表的用户id


5.**编写动态sql**：因为存在两个可能存在可能不存在的查询条件

* 动态sql比较复杂所以去xml的sql映射文件编写比较合适。
* **创建sql映射文件**：在resource下创建从java的下一级到mapper的路径




## 如何利用pageHelper

在service中

**实现步骤**

1.**创建pageBean对象**

2.**开启分页查询**

3.**在mapper中获取list集合**

4.**将list集合放到Page<>中**：因为pageBean的返回类型，需要返回一个page<>对象。注意要强制转换一下

5.**向pageBean写入参数**：条目数，数据

6.**返回pageBean对象**：

![image.png](/assets/3f3011ee-abad-481f-84a4-e2aaa65a5a51.png)
