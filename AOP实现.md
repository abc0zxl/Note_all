# AOP的应用

## 对象公共字段的操作，

这部分字段是自动填充的，如果不用AOP会有很多重复代码，所以用AOP方便

1.**AutoFIll是一个自定义注解**：

2.**在需要AOP的代码上添加扎个注解**：

2.通过反射为公共字段赋值

## 自定义一个切面注解的方法。

1.自定义一个注解

2.设置好注解的必要参数

* **指定数据库操作类型**：这个代码直接抄就好
* ![image.png](/assets/eaec104e-a924-4352-aeb0-ac73406b6228.png)
* OperationType是一个**枚举类型**，里面有两个类型**UPDATE**,**INSERT**这个是项目中的带啊吗内容
* 这个value()是这个**注解的方法名字**，这个Operatio是他的**类型**。

3.**编写AOP类**：

* 编写自定义切面类
* 编写标志注解Aspect，Component，Slf4j
* 自定义切入点用@Pointcut("AAAAA")

4.**编写切点表达式AAAA（也就是拦截位置）**：

要定位到某个方法，且包含上面设定的自定义注解@BBB的方法

* 定位到方法：

![image.png](/assets/95b5694d-bb95-4a49-9a81-def8eaae69c2.png)

* 定位到注解：标蓝的位置，这个是声明这个自定义注解类的位置

![image.png](/assets/f20985b1-154e-4828-815d-1711e7ced6b0.png)

5.**编写这个切点要增强的部分：**

* **指定通知类型**：前置，后置，后置异常，环绕
* **编写对应类型的注解**：注解的括号内容就是上面编写的**切点表达式方法名字**
* **加入链接点参数**：用JoinPoint参数类型获取到的参数，他可以获取到这个连接点**被拦截的方法名，方法的参数**

#### 编写好了AOP的框架接下来需要根据不同的切点方法来执行不同的代码

**例子**：这些被拦截的切点都有相同的被处理**实体对象**，但是每个方法所要处理的对象属性不同，

* 更新：处理更新时间属性
* 插入：处理创建时间属性

1.**获取拦截到的方法的数据库操作类型**：这里是特定的数据操作的AOP，别的AOP可能简单点

* 获取方法签名：他能获取到这个切点的方法名称，也许直接用这个名称来作为判断比较省事，但是这最根本的是数据库插入操作，该操作下可能有很多方法名。所以不能通过方法名称来作为最终执行方法的判断。这个操作类型在切点方法上的自定义注解的括号内。
* 获取方法上的注解对象
* 获得数据库操作类型

![image.png](/assets/cb023473-3396-4e55-9421-680b7b471b73.png)

2.**获取到这个方法索要处理的参数对象（实体对象）**：

![image.png](/assets/75288475-7901-410a-babe-b3813494f72d.png)

3.**对这个实体对象完成最终的赋值**。

* 这里要给切点的参数赋值，需要用到反射的方法
* 首先通过上面图片方式获取到的参数对象他的类型是未知的，所以无法对他操作
* **通过反射来
